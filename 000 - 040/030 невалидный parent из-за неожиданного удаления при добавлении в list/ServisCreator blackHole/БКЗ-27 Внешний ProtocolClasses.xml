<body>

<ProtocolClass name="БКЗ-27 ext">
  <Worker name="Состояние устройства периодическое" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param* sostoyanie { FindParamsInThisCategory('Состояние устройства') };&#xa;Param* otkazUvh { FindParamsInThisCategory('Отказ Uвх') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][СОСТ][canCur];&#xa;Эмулятор Data[0][0,1] = sostoyanie;&#xa;Эмулятор Data[0][2] = otkazUvh;&#xa;Сервис sostoyanie = Data[0][0,1];&#xa;Сервис otkazUvh = Data[0][2];"/>
  <Worker name="Состояние устройства апериодическое" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param* sostoyanie { FindParamsInThisCategory('Состояние устройства') };&#xa;Param* otkazUvh { FindParamsInThisCategory('Отказ Uвх') };" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][СОСТ][canCur];&#xa;Эмулятор Data[0][0,1] = sostoyanie;&#xa;Эмулятор Data[0][2] = otkazUvh;&#xa;Сервис sostoyanie = Data[0][0,1];&#xa;Сервис otkazUvh = Data[0][2];"/>
  <Worker name="Данные об изделии запрос" category="БКЗ-27:1" id="" type="Входящий_кадр" addProterties="" variables="bool запросНомера;&#xa;bool запросВерсии;&#xa;Worker* ответ { FindWorker('Данные об изделии ответ') };" frame="ID: [tmc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ДИЗД][canCur];&#xa;Сервис if(запросНомера == 1) Data[0][0] = 1;&#xa;Сервис if(запросВерсии == 1) Data[0][1] = 1;&#xa;Сервис if(Data[0] == 0) Print('Warning', 'Пустой запрос данных об изделии');&#xa;Сервис if(Data[0] == 3) Print('Warning', 'Запрос номера и версии сразу');&#xa;&#xa;Эмулятор if(Data[0] == 0) Print('Warning', 'Пустой запрос данных об изделии');&#xa;Эмулятор if(Data[0] == 3) Print('Warning', 'Запрос номера и версии сразу');&#xa;Эмулятор запросНомера = Data[0][0];&#xa;Эмулятор запросВерсии = Data[0][1];&#xa;Эмулятор SendFrame(ответ);"/>
  <Worker name="Данные об изделии ответ" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Worker* запрос { FindWorker('Данные об изделии запрос') };&#xa;Param* завНомер { FindParamsInThisCategory('Заводской номер') };&#xa;Param* версияПО { FindParamsInThisCategory('Версия ПО') };" frame="ID: [tmc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ДИЗД][canCur];&#xa;Эмулятор if(запрос.запросНомера == 1) Data[0-3] = завНомер;&#xa;Эмулятор if(запрос.запросВерсии == 1) Data[0-3] = версияПО;&#xa;Сервис if(запрос.запросНомера == 1) завНомер = Data[0-3];&#xa;Сервис if(запрос.запросВерсии == 1) версияПО = Data[0-3];"/>
  <Import type="ProtocolClass" name="БКЗ-27 ext каналы" policy="" modification="" postModification=""/>
  <Worker name="периодическая отправка 1 Гц" category="БКЗ-27:1" id="" type="Эмулятор Таймер {1000}" addProterties="" variables="Worker* кз { FindWorker('короткое замыкание периодический') };&#xa;Worker* перегрузка { FindWorker('перегрузка периодический') };&#xa;Worker* отказВыхода { FindWorker('отказ выхода периодический') };&#xa;Worker* отказНагрузки { FindWorker('отказ нагрузки периодический') };&#xa;Worker* состояниеУстройства { FindWorker('Состояние устройства периодическое') };" frame="Эмулятор SendFrame(кз);&#xa;Эмулятор SendFrame(перегрузка);&#xa;Эмулятор SendFrame(отказВыхода);&#xa;Эмулятор SendFrame(отказНагрузки);&#xa;Эмулятор SendFrame(состояниеУстройства);"/>
  <Worker name="периодическая отправка 2,5 Гц" category="БКЗ-27:1" id="" type="Эмулятор Таймер {400}" addProterties="" variables="Worker* вклИнфо { FindWorker('вкл инфо периодический') };&#xa;Worker* исправностьКаналов { FindWorker('исправность периодический') };" frame="Эмулятор SendFrame(вклИнфо);&#xa;Эмулятор SendFrame(исправностьКаналов);"/>
</ProtocolClass>

<ProtocolClass name="БКЗ-27 ext каналы">
  <Worker name="вкл инфо периодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] вклВыклКаналов { FindParams('ВКЛ/ВЫКЛ') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ВКЛСОСТ][canCur];&#xa;Эмулятор Data = вклВыклКаналов;&#xa;Сервис  вклВыклКаналов = Data[][0-47];"/>
  <Worker name="вкл инфо апериодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] вклВыклКаналов { FindParams('ВКЛ/ВЫКЛ') };" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ВКЛСОСТ][canCur];&#xa;Эмулятор Data = вклВыклКаналов;&#xa;Сервис  вклВыклКаналов = Data[][0-47];"/>
  <Worker name="вкл упр периодический" category="БКЗ-27:1" id="" type="Входящий_кадр" addProterties="" variables="Param*[] вклВыклКаналов { FindParams('ВКЛ/ВЫКЛ') };&#xa;bool[] новыеСостояния;" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ВКЛУПР][canCur];&#xa;Сервис Data = новыеСостояния;&#xa;Эмулятор вклВыклКаналов = Data[][0-47];&#xa;"/>
  <Worker name="вкл упр апериодический" category="БКЗ-27:1" id="" type="Входящий_кадр" addProterties="" variables="Param*[] вклВыклКаналов { FindParams('ВКЛ/ВЫКЛ') };&#xa;bool[] новыеСостояния;" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ВКЛУПР][canCur];&#xa;Сервис Data = новыеСостояния;&#xa;Эмулятор вклВыклКаналов = Data[][0-47];"/>
  <Worker name="сброс защиты периодический" category="БКЗ-27:1" id="" type="Входящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Короткое замыкание') };&#xa;bool сброс;&#xa;bool[] новыеСостояния {	0,0,0,0,0,0,0,0,0,0,    0,0,0,0,0,0,0,0,0,0, &#xa;			0,0,0,0,0,0,0,0,0,0,    0,0,0,0,0,0,0,0,0,0,   0,0,0,0,0,0,0,0};" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][СБРЗАЩ][canCur];&#xa;Сервис Data[0][0] = сброс;&#xa;Эмулятор if(Data[0][0] == 1) параметры = новыеСостояния;&#xa;"/>
  <Worker name="сброс защиты апериодический" category="БКЗ-27:1" id="" type="Входящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Короткое замыкание') };&#xa;bool сброс;&#xa;bool[] новыеСостояния {	0,0,0,0,0,0,0,0,0,0,    0,0,0,0,0,0,0,0,0,0, &#xa;			0,0,0,0,0,0,0,0,0,0,    0,0,0,0,0,0,0,0,0,0,   0,0,0,0,0,0,0,0};" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][СБРЗАЩ][canCur];&#xa;Сервис Data[0][0] = сброс;&#xa;Эмулятор if(Data[0][0] == 1) параметры = новыеСостояния;"/>
  <Worker name="исправность периодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Исправность') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ИСПР][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="короткое замыкание периодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Короткое замыкание') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][КЗ][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="короткое замыкание апериодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Короткое замыкание') };" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][КЗ][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="перегрузка периодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Перегрузка') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ПЕРЕГР][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="перегрузка апериодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Перегрузка') };" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ПЕРЕГР][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="отказ выхода периодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Отказ выхода') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ОТКВЫХ][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="отказ выхода апериодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Отказ выхода') };" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ОТКВЫХ][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="отказ нагрузки периодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Отказ нагрузки') };" frame="ID: [noc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ОТКНАГР][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="отказ нагрузки апериодический" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Отказ нагрузки') };" frame="ID: [eec][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ОТКНАГР][canCur];&#xa;Эмулятор Data = параметры;&#xa;Сервис  параметры = Data[][0-47];"/>
  <Worker name="ток канала запрос" category="БКЗ-27:1" id="" type="Входящий_кадр" addProterties="" variables="ubyte[] номераКаналов;&#xa;Worker* ответ { FindWorker('ток канала ответ') };" frame="ID: [tmc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ТОК][canCur];&#xa;Сервис Data[0-3] = номераКаналов;&#xa;Эмулятор номераКаналов = Data[0-3];&#xa;Эмулятор SendFrame(ответ);"/>
  <Worker name="ток канала ответ" category="БКЗ-27:1" id="" type="Исходящий_кадр" addProterties="" variables="Param*[] параметры { FindParams('Ток канала') };&#xa;Worker* запрос { FindWorker('ток канала запрос') };&#xa;ushort номерПараметра;" frame="ID: [tmc][SrcF13][RSD][LCL][PVT][SSCDC][UNCurr][ТОК][canCur];&#xa;Эмулятор номерПараметра = запрос.номераКаналов[0] - 1;&#xa;Эмулятор Data[0,1] = параметры[номерПараметра];&#xa;Эмулятор номерПараметра = запрос.номераКаналов[1] - 1;&#xa;Эмулятор Data[2,3] = параметры[номерПараметра];&#xa;Эмулятор номерПараметра = запрос.номераКаналов[2] - 1;&#xa;Эмулятор Data[4,5] = параметры[номерПараметра];&#xa;Эмулятор номерПараметра = запрос.номераКаналов[3] - 1;&#xa;Эмулятор Data[6,7] = параметры[номерПараметра];&#xa;Сервис номерПараметра = запрос.номераКаналов[0] - 1;&#xa;Сервис параметры[номерПараметра] = Data[0,1];&#xa;Сервис номерПараметра = запрос.номераКаналов[1] - 1;&#xa;Сервис параметры[номерПараметра] = Data[2,3];&#xa;Сервис номерПараметра = запрос.номераКаналов[2] - 1;&#xa;Сервис параметры[номерПараметра] = Data[4,5];&#xa;Сервис номерПараметра = запрос.номераКаналов[3] - 1;&#xa;Сервис параметры[номерПараметра] = Data[6,7];&#xa;&#xa;"/>
</ProtocolClass>

</body>